## Product UseCase 프로젝트 문서: 상담 기록 유형 분석 및 알림 자동화 시스템

### 1. 프로젝트 개요

* **프로젝트명**: Product UseCase 프로젝트 데모 - 상담 기록 유형 분석 및 알림 자동화
* **목표**: 비영리 단체에서 수집한 상담 데이터를 기반으로, 상담 기록을 구조화하고, 자동 요약·유형 분류·유사 사례 추천 및 위험 알림을 통해 사례관리자의 행정 부담을 줄이고 대응 속도를 높이는 시스템을 구축

---

### 2. 프로젝트 참여자

* **담당자**: 송휘린, 윤희찬, 문찬우, 김민서, 방준현

---

### 3. 사용자의 니즈

1. 상담 기록의 누적: 수기·PDF 문서가 통합되지 않아 검색 및 분석 어려움
2. 고위험 케이스 탐지 어려움: 자살/폭력 등 고위험 문구를 수작업으로 판별
3. 사례 검색 및 공유의 어려움: 유사 사례를 수동으로 찾아야 하는 비효율

---

### 4. 산출물 목록

* 프로젝트 코드: `app.py`, `search.py` 등
* Vector DB 인덱스: `faiss.index` (AI-Hub 임베딩 DB)
* 실행 스크립트: `requirements.txt`, `run_demo.sh`
* 데모 문서: 시연용 PDF 샘플 문서 1건
* 데모 가이드: 데모 가이드 템플릿 참고

---

### 5. 데이터셋 개요

* **출처**: 아동·청소년 상담데이터 (AI Hub)
* **특징**:

  * 상담 발화 텍스트
  * 위기 단계/학대 유형 등 다양한 메타데이터 라벨 포함
* **레퍼런스**:

  * 웰니스 대화 스크립트 데이터셋 (AI Hub)
  * 복지 분야 콜센터 상담 데이터 (음성)
  * 청소년 또래상담 데이터

---

### 6. 전체 파이프라인

#### 시스템 구축 단계

| 단계 | 모듈              | 설명                         |
| -- | --------------- | -------------------------- |
| 1  | Data Loader     | AI-Hub 상담 데이터셋 로드          |
| 2  | Text Clean      | 이름, 학교 등 민감 정보 익명화         |
| 3  | Solar Embedding | Upstage API로 벡터 임베딩 수행     |
| 4  | Vector DB 구축    | FAISS를 사용한 유사 사례 검색 인덱스 구축 |

#### 사용자 시나리오 단계

| 단계 | 모듈             | 설명                       |
| -- | -------------- | ------------------------ |
| 1  | PDF 업로드        | 사용자가 상담기록(PDF) 업로드       |
| 2  | Document Parse | 문서를 HTML 형태로 파싱          |
| 3  | Text Clean     | 전처리 및 익명화 처리             |
| 4  | Summarize      | Solar LLM 기반 요약 생성       |
| 5  | Embedding      | 유사도 기반 검색을 위한 임베딩 수행     |
| 6  | Retrieval      | Vector DB로부터 유사 사례 N건 검색 |
| 7  | Classification | 상담 유형, 위기 단계, 학대 유형 분류   |
| 8  | Dash           | 전체 결과 시각화 및 메일 발송 알림     |

---

### 7. 기능 명세서

#### 시스템 구축 파이프라인

| # | 모듈                 | 설명                | 입력      | 출력          | 비고                    |
| - | ------------------ | ----------------- | ------- | ----------- | --------------------- |
| 1 | AI-Hub Data Loader | AI-Hub 데이터셋 로딩    | \*.json | 원문 텍스트      |                       |
| 2 | Text Clean & 익명화   | 이름/학교/지역 등 마스킹 처리 | 원문 텍스트  | 정제 텍스트      |                       |
| 3 | Solar Embedding    | 상담 내용을 벡터화        | 정제 텍스트  | 벡터          | Upstage Embedding API |
| 4 | Vector DB 구축       | 검색용 DB 구축         | 벡터 + 메타 | faiss.index |                       |

#### 사용자 흐름 파이프라인

| # | 모듈               | 설명                        | 입력     | 출력           | 비고             |
| - | ---------------- | ------------------------- | ------ | ------------ | -------------- |
| 1 | PDF 업로드          | 사용자 상담기록 업로드              | PDF    | 파일 경로        |                |
| 2 | Document Parse   | 문서 OCR + 구조화              | PDF    | HTML 텍스트     | Upstage API 사용 |
| 3 | Text Clean & 익명화 | 텍스트 전처리 및 익명화             | 텍스트    | 정제 텍스트       |                |
| 4 | Solar LLM 요약     | 핵심 내용 요약                  | 정제 텍스트 | 요약문          |                |
| 5 | Solar Embedding  | 임베딩 벡터 생성                 | 정제 텍스트 | 벡터           |                |
| 6 | 유사 사례 검색         | FAISS를 통해 3건 검색           | 벡터     | 유사 사례 리스트    |                |
| 7 | Solar LLM 분류     | 상담 유형, 위기 단계, 학대 유형 분류    | 정제 텍스트 | 분류 결과 (JSON) |                |
| 8 | 위험 알림            | 위기단계≥3 또는 학대≠없음일 경우 메일 발송 | 분류 결과  | 메일 전송 로그     |                |
| 9 | 대시보드             | 요약, 유형, 유사사례, 로그 시각화      | 전체 결과  | 웹 페이지        | Streamlit 등 사용 |

---

### 8. 대시보드 구성

| 섹션       | 구성 요소                       | 예시            |
| -------- | --------------------------- | ------------- |
| 업로드창     | PDF drag & drop, 처리 상태 표시   | ✅ Upload 성공   |
| 요약 결과    | 상담 요약 (3줄), 상담 유형 태그        | "가정폭력으로 인해…"  |
| 위험 분석    | 위기단계 Badge (색상), 학대 유형 Chip | 위기 단계 3, 정서학대 |
| 유사 사례    | AI-Hub에서 가장 유사한 3건 요약 카드    | 유사도 점수 표시     |
| 위험 알림 로그 | 메일 전송 결과 및 시간               | 메일 전송됨 13:49  |

---

### 9. 배포 가이드

이 프로젝트는 Streamlit을 사용하여 제작된 웹 애플리케이션입니다. 아래의 방법으로 로컬에서 실행하거나 Streamlit Cloud에 배포할 수 있습니다.

#### 9-1 로컬 실행

1. **필수 라이브러리 설치**

pip install -r requirements.txt

2. **앱 실행**

streamlit run app.py

#### 9-2 Streamlit Cloud 배포

1. **☁️ Streamlit Cloud 배포**
GitHub 저장소 준비

프로젝트 코드를 GitHub에 업로드합니다.

app.py가 루트 또는 지정된 폴더에 있어야 합니다.

requirements.txt 파일 포함 필수입니다.

2. **Streamlit Cloud 접속**

https://streamlit.io/cloud 에서 로그인 후, "New app" 클릭

GitHub 저장소 선택 및 브랜치 / 실행 파일 경로 설정 (app.py)

env.exmple의 형식에 맞춰 secret에 env 입력

3. **배포 및 사용**

자동으로 앱이 빌드되어 배포됩니다.

배포 후 생성된 URL로 접근 가능


